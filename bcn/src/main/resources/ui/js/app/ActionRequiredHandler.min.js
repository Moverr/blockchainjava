
var ActionRequiredHandler=function(){ActionRequiredHandler.self=this;loanList.addDataModelChangedEventListenerCallback(ActionRequiredHandler.prototype._dataModelChanged);savingsAccountList.addDataModelChangedEventListenerCallback(ActionRequiredHandler.prototype._dataModelChanged);shareList.addDataModelChangedEventListenerCallback(ActionRequiredHandler.prototype._dataModelChanged)};ActionRequiredHandler.OVERVIEW_TITLES={type:"Items available",number:"Number"};ActionRequiredHandler.prototype.overview=function(){addHistory("Action required overview","#actionRequiredOverview","#actionRequired");initDefaultContent("Action required");currentTable="actionRequired";clearExportButtons();$("#syncNow").off("click touch");$("#syncNow").attr("title","Nothing to sync");$("#printNow").off("click touch");$("#printNow").hide();var c=getDefaultRowContainer(ActionRequiredHandler.OVERVIEW_TITLES);var d=$('span[data-counterkey="loanApplications"]').data("counter");var f=$('span[data-counterkey="loanApproved"]').data("counter");var h=$('span[data-counterkey="loanDisbursements"]').data("counter");var e=$('span[data-counterkey="loanDisburse"]').data("counter");var b=$('span[data-counterkey="savingsAccountApplications"]').data("counter");var a=$('span[data-counterkey="sharePurchaseApplications"]').data("counter");var g=$('span[data-counterkey="shareSaleApplications"]').data("counter");if(handlers.Permissions.check_access("_APPROVE_LOAN_APPLICATIONS")){addRow(c,{type:"Approve Loan Applications",number:'<span data-counter="'+d+'" data-counterkey="loanApplications">'+d+"</span>"},"Loan",ActionRequiredHandler.self.rowClickHandler,"getApplications")}if(handlers.Permissions.check_access("_SIGN_LOAN_CONTRACT")){addRow(c,{type:"Sign Loan Contracts",number:'<span data-counter="'+f+'" data-counterkey="loanApproved">'+f+"</span>"},"Loan",ActionRequiredHandler.self.rowClickHandler,"getSingngContracts")}if(handlers.Permissions.check_access("_MANAGE_LOAN_DISBURSEMENT")){addRow(c,{type:"Allow Loan Disbursements",number:'<span data-counter="'+h+'" data-counterkey="loanDisbursements">'+h+"</span>"},"Loan",ActionRequiredHandler.self.rowClickHandler,"getDisbursements")}if(handlers.Permissions.check_access("_APPROVE_LOAN_DISBURSEMENT")){addRow(c,{type:"Disburse Loan",number:'<span data-counter="'+e+'" data-counterkey="loanDisburse">'+e+"</span>"},"Loan",ActionRequiredHandler.self.rowClickHandler,"getAllowedDisbursements")}if(handlers.Permissions.check_access("_MANAGE_SAVINGS_ACCOUNTS")){addRow(c,{type:"Savings account applications",number:'<span data-counter="'+b+'" data-counterkey="savingsAccountApplications">'+b+"</span>"},"SavingsAccount",ActionRequiredHandler.self.rowClickHandler,"getApplications")}};ActionRequiredHandler.prototype.rowClickHandler=function(){var b=$(this).data("id");var a=$(this).data("object");$('li[data-parent~="actionRequired"][data-handler="'+a+'"][data-action~="'+b+'"] a').click()};ActionRequiredHandler.prototype._loanApplicationsRowClickHandler=function(){$("#actionRequired-loanApplications").click()};ActionRequiredHandler.prototype._loanDisbursementsRowClickHandler=function(){$("#actionRequired-loanDisbursements").click()};ActionRequiredHandler.prototype._savingsAccountApplicationsRowClickHandler=function(){$("#actionRequired-savingsAccountApplications").click()};ActionRequiredHandler.prototype._savingsAccountApplicationsRowClickHandler=function(){$("#actionRequired-savingsAccountApplications").click()};ActionRequiredHandler.prototype._dataModelChanged=function(){var e=loanList.getSubmittedCount();var d=loanList.getContractSignedCount();var c=loanList.getApprovedCount();var a=loanList.getDisburesmentAllowedCount();var b=savingsAccountList.getCountByStatus("SUBMITTED");var i=shareList.getCountByStatus("SUBMITTED_FOR_PURCHASE");var g=shareList.getCountByStatus("SUBMITTED_FOR_SALE");var f;f=$('span[data-counterkey="loanApplications"]');f.data("counter",e);f.text(e);if(e===0&&!f.parent().is("td")){f.hide()}else{f.show()}f=$('span[data-counterkey="loanApproved"]');f.data("counter",c);f.text(c);if(c===0&&!f.parent().is("td")){f.hide()}else{f.show()}f=$('span[data-counterkey="loanDisburse"]');f.data("counter",a);f.text(a);if(a===0&&!f.parent().is("td")){f.hide()}else{f.show()}f=$('span[data-counterkey="loanDisbursements"]');f.data("counter",d);f.text(d);if(d===0&&!f.parent().is("td")){f.hide()}else{f.show()}f=$('span[data-counterkey="savingsAccountApplications"]');f.data("counter",b);f.text(b);if(b===0&&!f.parent().is("td")){f.hide()}else{f.show()}f=$('span[data-counterkey="sharePurchaseApplications"]');f.data("counter",i);f.text(i);if(i===0&&!f.parent().is("td")){f.hide()}else{f.show()}f=$('span[data-counterkey="shareSaleApplications"]');f.data("counter",g);f.text(g);if(g===0&&!f.parent().is("td")){f.hide()}else{f.show()}f=$('span[data-counterkey="actionRequired"]');f.data("counter",e+a+d+c+b+i+g);var h=0;if(handlers.Permissions.check_access("_MANAGE_SAVINGS_ACCOUNTS")){h+=b}if(handlers.Permissions.check_access("_APPROVE_LOAN_DISBURSEMENT")){h+=a}if(handlers.Permissions.check_access("_MANAGE_LOAN_DISBURSEMENT")){h+=d}if(handlers.Permissions.check_access("_SIGN_LOAN_CONTRACT")){h+=e}if(handlers.Permissions.check_access("_APPROVE_LOAN_APPLICATIONS")){h+=c}if(h>0){f.text(h);f.show()}else{f.hide()}};