/*!
 * TableExport.js v3.2.5 (http://www.clarketravis.com)
 * Copyright 2016 Travis Clarke
 * Licensed under the MIT license
 */
(function(g,b){var d=g.jQuery;d.fn.tableExport=function(t,s){var o=this,l=s?t:d.extend({},d.fn.tableExport.defaults,t),j=d.fn.tableExport.rowDel,p=l.ignoreRows instanceof Array?l.ignoreRows:[l.ignoreRows],m=l.ignoreCols instanceof Array?l.ignoreCols:[l.ignoreCols],n=l.ignoreCSS instanceof Array?l.ignoreCSS.join(", "):l.ignoreCSS,q,r,k;if(l.bootstrap){q=d.fn.tableExport.bootstrap[0]+" ";r=d.fn.tableExport.bootstrap[1]+" ";k=d.fn.tableExport.bootstrap[2]+" "}else{q=d.fn.tableExport.defaultButton+" ";r=k=""}o.each(function(){var E=d(this);if(s){E.find("caption:not(.head)").remove()}var C=E.find("tbody").find("tr"),C=l.headings?C.add(E.find("thead>tr")):C,C=l.footers?C.add(E.find("tfoot>tr")):C,z=l.headings?E.find("thead>tr").length:0,y=l.fileName==="id"?(E.attr("id")?E.attr("id"):d.fn.tableExport.defaultFileName):l.fileName,x={xlsx:function(J,F){var K=C.map(function(M,N){if(!!~p.indexOf(M-z)||d(N).is(n)){return}var L=d(N).find("th, td");return[L.map(function(O,P){if(!!~m.indexOf(O)||d(P).is(n)){return}return d(P).text()}).get()]}).get(),I=c(JSON.stringify({data:K,fileName:F,mimeType:d.fn.tableExport.xlsx.mimeType,fileExtension:d.fn.tableExport.xlsx.fileExtension})),H=d.fn.tableExport.xlsx.buttonContent,G=d.fn.tableExport.xlsx.defaultClass;u(I,H,G)},xls:function(G,H){var F=d.fn.tableExport.xls.separator,L=C.map(function(N,O){if(!!~p.indexOf(N-z)||d(O).is(n)){return}var M=d(O).find("th, td");return M.map(function(P,Q){if(!!~m.indexOf(P)||d(Q).is(n)){return}return d(Q).text()}).get().join(F)}).get().join(G),K=c(JSON.stringify({data:L,fileName:H,mimeType:d.fn.tableExport.xls.mimeType,fileExtension:d.fn.tableExport.xls.fileExtension})),J=d.fn.tableExport.xls.buttonContent,I=d.fn.tableExport.xls.defaultClass;u(K,J,I)},csv:function(G,H){var F=d.fn.tableExport.csv.separator,L=C.map(function(N,O){if(!!~p.indexOf(N-z)||d(O).is(n)){return}var M=d(O).find("th, td");return M.map(function(P,Q){if(!!~m.indexOf(P)||d(Q).is(n)){return}return d(Q).text()}).get().join(F)}).get().join(G),K=c(JSON.stringify({data:L,fileName:H,mimeType:d.fn.tableExport.csv.mimeType,fileExtension:d.fn.tableExport.csv.fileExtension})),J=d.fn.tableExport.csv.buttonContent,I=d.fn.tableExport.csv.defaultClass;u(K,J,I)},txt:function(G,H){var F=d.fn.tableExport.txt.separator,L=C.map(function(N,O){if(!!~p.indexOf(N-z)||d(O).is(n)){return}var M=d(O).find("th, td");return M.map(function(P,Q){if(!!~m.indexOf(P)||d(Q).is(n)){return}return d(Q).text()}).get().join(F)}).get().join(G),K=c(JSON.stringify({data:L,fileName:H,mimeType:d.fn.tableExport.txt.mimeType,fileExtension:d.fn.tableExport.txt.fileExtension})),J=d.fn.tableExport.txt.buttonContent,I=d.fn.tableExport.txt.defaultClass;u(K,J,I)}};l.formats.forEach(function(F){x[F](j,y)});function w(F){var G=E.find("caption:not(.head)");G.length?G.append(F):E.prepend('<caption class="'+k+l.position+'">'+F+"</caption>")}function D(F){d("#exportToXlsDiv").empty();d("#exportToXlsDiv").html(F)}function v(F){d("#exportToXlsxDiv").empty();d("#exportToXlsxDiv").html(F)}function B(F){d("#exportToTxtDiv").empty();d("#exportToTxtDiv").html(F)}function A(F){d("#exportToPdfDiv").empty();d("#exportToPdfDiv").html(F)}function u(H,G,F){var I="";if(F==="xlsx"){I="<button data-fileblob='"+H+'\' class=\'btn customCancelButton\' style="background-color: #404040;"><i class="mdl-color-text--white material-icons" role="presentation">file_download</i>'+G+"</button>";v(I)}if(F==="xls"){I="<button data-fileblob='"+H+'\' class=\'btn customCancelButton\' style="background-color: #404040;"><i class="mdl-color-text--white material-icons" role="presentation">file_download</i>'+G+"</button>";D(I)}if(F==="csv"){I="<button data-fileblob='"+H+'\' class=\'btn customCancelButton\' style="background-color: #404040;"><i class="mdl-color-text--white material-icons" role="presentation">file_download</i>'+G+"</button>";A(I)}if(F==="txt"){I="<button data-fileblob='"+H+'\' class=\'btn customCancelButton\' style="background-color: #404040;"><i class="mdl-color-text--white material-icons" role="presentation">file_download</i>'+G+"</button>";B(I)}}});d("button[data-fileblob]").off("click").on("click",function(){var u=d(this).data("fileblob"),v=u.data,y=u.fileName,x=u.mimeType,w=u.fileExtension;i(v,x,y,w)});d.fn.tableExport.update=function(u){o.tableExport(d.extend({},l,u),true)};d.fn.tableExport.reset=function(u){o.tableExport(l,true)};d.fn.tableExport.remove=function(u){o.each(function(){d(this).find("caption:not(.head)").remove()})};return o};d.fn.tableExport.defaults={headings:true,footers:true,formats:["xls","xlsx"],fileName:"id",bootstrap:true,position:"bottom",ignoreRows:null,ignoreCols:null,ignoreCSS:".tableexport-ignore"};d.fn.tableExport.charset="charset=utf-8";d.fn.tableExport.xlsx={defaultClass:"xlsx",buttonContent:"Export to xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileExtension:".xlsx"};d.fn.tableExport.xls={defaultClass:"xls",buttonContent:"Export to xls",separator:"\t",mimeType:"application/vnd.ms-excel",fileExtension:".xls"};d.fn.tableExport.csv={defaultClass:"csv",buttonContent:"Export to csv",separator:",",mimeType:"application/csv",fileExtension:".csv"};d.fn.tableExport.txt={defaultClass:"txt",buttonContent:"Export to txt",separator:"  ",mimeType:"text/plain",fileExtension:".txt"};d.fn.tableExport.defaultFileName="Awamo Report";d.fn.tableExport.defaultButton="customCancelButton";d.fn.tableExport.bootstrap=["btn","customCancelButton","btn-toolbar"];d.fn.tableExport.rowDel="\r\n";d.fn.tableExport.entityMap={"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47"};function c(j){return String(j).replace(/[&<>'\/]/g,function(k){return d.fn.tableExport.entityMap[k]})}function a(k,j){if(j){k+=1462}var l=Date.parse(k);return(l-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000)}function e(p,o){var k={};var l={s:{c:10000000,r:10000000},e:{c:0,r:0}};for(var n=0;n!=p.length;++n){for(var q=0;q!=p[n].length;++q){if(l.s.r>n){l.s.r=n}if(l.s.c>q){l.s.c=q}if(l.e.r<n){l.e.r=n}if(l.e.c<q){l.e.c=q}var j={v:p[n][q]};if(j.v==null){continue}var m=XLSX.utils.encode_cell({c:q,r:n});if(typeof j.v==="number"){j.t="n"}else{if(typeof j.v==="boolean"){j.t="b"}else{if(j.v instanceof Date){j.t="n";j.z=XLSX.SSF._table[14];j.v=a(j.v)}else{j.t="s"}}}k[m]=j}}if(l.s.c<10000000){k["!ref"]=XLSX.utils.encode_range(l)}return k}function h(){if(!(this instanceof h)){return new h()}this.SheetNames=[];this.Sheets={}}function f(m){var k=new ArrayBuffer(m.length);var j=new Uint8Array(k);for(var l=0;l!=m.length;++l){j[l]=m.charCodeAt(l)&255}return k}function i(p,o,k,q){if(q===".xlsx"){var n=new h(),j=e(p);n.SheetNames.push(k);n.Sheets[k]=j;var m={bookType:"xlsx",bookSST:false,type:"binary"},l=XLSX.write(n,m);p=f(l)}saveAs(new Blob([p],{type:o+";"+d.fn.tableExport.charset}),k+q)}}(window));