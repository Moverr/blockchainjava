(function(c){var b={containerid:null,datatype:"table",dataset:null,columns:null,returnUri:false,worksheetName:"My Worksheet",encoding:"utf-8",fileName:"dataExport"};var a=b;c.fn.excelexportjs=function(o){a=c.extend({},b,o);var l=[];var f;return g();function g(){var q=a.datatype.toLowerCase();var r=a.fileName;e(q);switch(q){case"table":f=m(h(),r);break;case"json":f=m(i(),r);break;case"xml":f=m(i(),r);break;case"jqgrid":f=m(i(),r);break}if(a.returnUri){console.log("1st if");return f}else{if(!k()){var p=document.createElement("A");p.href=f;p.download=r+".xls";document.body.appendChild(p);p.click();document.body.removeChild(p)}}}function e(p){switch(p){case"table":break;case"json":l=a.dataset;break;case"xml":c(a.dataset).find("row").each(function(q,s){var r={};if(this.attributes!=null&&this.attributes.length>0){c(this.attributes).each(function(){r[this.name]=this.value});l.push(r)}});break;case"jqgrid":c(a.dataset).find("rows > row").each(function(q,s){var r={};if(this.children!=null&&this.children.length>0){c(this.children).each(function(){r[this.tagName]=c(this).text()});l.push(r)}});break}}function h(){var p=c("<div>").append(c("#"+a.containerid).clone()).html();return p}function i(){var p="<table id='tabledata'>";p+="<thead><tr>";c(a.columns).each(function(q,r){if(this.ishidden!=true){p+="<th";if(this.width!=null){p+=" style='width: "+this.width+"'"}p+=">";p+=this.headertext;p+="</th>"}});p+="</tr></thead>";p+="<tbody>";c(l).each(function(q,r){p+="<tr>";c(a.columns).each(function(t,s){if(r.hasOwnProperty(this.datafield)){if(this.ishidden!=true){p+="<td";if(this.width!=null){p+=" style='width: "+this.width+"'"}p+=">";p+=r[this.datafield];p+="</td>"}}});p+="</tr>"});p+="</tbody>";p+="</table>";return p}function m(s,t){if(k()){d(s,t)}else{var p="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>";p+="<head>";p+='<meta http-equiv="Content-type" content="text/html;charset='+b.encoding+'" />';p+="<!--[if gte mso 9]>";p+="<xml>";p+="<x:ExcelWorkbook>";p+="<x:ExcelWorksheets>";p+="<x:ExcelWorksheet>";p+="<x:Name>";p+="{worksheet}";p+="</x:Name>";p+="<x:WorksheetOptions>";p+="<x:DisplayGridlines/>";p+="</x:WorksheetOptions>";p+="</x:ExcelWorksheet>";p+="</x:ExcelWorksheets>";p+="</x:ExcelWorkbook>";p+="</xml>";p+="<![endif]-->";p+="</head>";p+="<body>";p+=s.replace(/"/g,"'");p+="</body>";p+="</html>";var r="data:application/vnd.ms-excel;base64,";var q={worksheet:a.worksheetName,table:s};return(r+j(n(p,q)))}}function j(p){return window.btoa(unescape(encodeURIComponent(p)))}function n(p,q){return p.replace(/{(\w+)}/g,function(r,s){return q[s]})}function k(){var p=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g);if(p>0){return true}else{return false}}function d(w,s){var q=document.createElement("div");q.innerHTML=w;var u="<table border='2px'><tr bgcolor='#87AFC6'>";var x;var t=0;var r;if(a.datatype.toLowerCase()=="table"){r=document.getElementById(a.containerid)}else{r=q.children[0]}for(t=0;t<r.rows.length;t++){u=u+r.rows[t].innerHTML+"</tr>"}u=u+"</table>";u=u.replace(/<A[^>]*>|<\/A>/g,"");u=u.replace(/<img[^>]*>/gi,"");u=u.replace(/<input[^>]*>|<\/input>/gi,"");var p=window.navigator.userAgent;var v=p.indexOf("MSIE ");if(v>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){txtArea1.document.open("txt/html","replace");txtArea1.document.write(u);txtArea1.document.close();txtArea1.focus();sa=txtArea1.document.execCommand("SaveAs",true,s)}else{sa=window.open("data:application/vnd.ms-excel,"+encodeURIComponent(u))}return(sa)}}})(jQuery);function getColumns(a){var b=[];$.each(a[0],function(c,d){var e={};e.headertext=c;e.datatype="string";e.datafield=c;b.push(e)});return b};